cat(expression(sigma), sigma, expression(sigma^2), sigma2, "\n")
sigma <- mean(diff(global$Annual))
sigma2 <- var(diff(global$Annual))
print(sigma, sigma2)
sigma <- mean(diff(global$Annual))
sigma2 <- var(diff(global$Annual))
print(sigma)
sigma <- mean(diff(global$Annual))
sigma2 <- var(diff(global$Annual))
print(paste(sigma, sigma2))
sigma <- mean(diff(global$Annual))
sigma2 <- var(diff(global$Annual))
sigma, sigma2
sigma <- mean(diff(global$Annual))
sigma2 <- var(diff(global$Annual))
sigma
sigma2
help(nnrom)
help(nnorm)
help(pnorm)
set.seed(123)
N <- length(global$Annual)
w <- rnorm(N, mean = 0, sd = sd(diff(global$Annual)))
y <- numeric(N)
for (n in 2:N) {
y[n] <- y[n-1] + sigma + w[n]
}
plot(global$Year, y, xlab = "Year", ylab = "temperature", main = "Random walk with drift simulation")
set.seed(123)
N <- length(global$Annual)
w <- rnorm(N, mean = 0, sd = sd(diff(global$Annual)))
y <- numeric(N)
for (n in 2:N) {
y[n] <- y[n-1] + sigma + w[n]
}
plot(global$Year, y, type = "l", xlab = "Year", ylab = "temperature", main = "Random walk with drift simulation")
arima(global$Annual, order = c(1,0,1))
aic_table <- function(data,P,Q){
table <- matrix(NA,(P+1),(Q+1))
for(p in 0:P) {
for(q in 0:Q) {
table[p+1,q+1] <- arima(data,order=c(p,0,q))$aic
}
}
dimnames(table) <- list(paste("AR",0:P, sep=""),
paste("MA",0:Q,sep=""))
table
}
temp_aic_table <- aic_table(global$Annual,4,4)
arima(global$Annual, order = c(1,0,1), method = "ML")
arima(global$Annual, order = c(1,0,0), method = "ML")
dat <- read.table(file = "~/Library/Mobile Documents/com~apple~CloudDocs/531/Stats531/05/huron_level.csv", sep = ",", header = TRUE)
huron_level <- dat$Jan
temp <- global$Annual
temp <- global$Annual
aic_table <- function(data,P,Q){
table <- matrix(NA,(P+1),(Q+1))
for(p in 0:P) {
for(q in 0:Q) {
table[p+1,q+1] <- arima(data,order=c(p,0,q), method = "ML")$aic
}
}
dimnames(table) <- list(paste("AR",0:P, sep=""),
paste("MA",0:Q,sep=""))
table
}
temp_aic_table <- aic_table(temp,4,4)
temp <- global$Annual
aic_table <- function(data,P,Q){
table <- matrix(NA,(P+1),(Q+1))
for(p in 0:P) {
for(q in 0:Q) {
table[p+1,q+1] <- arima(data,order=c(p,0,q))$aic
}
}
dimnames(table) <- list(paste("AR",0:P, sep=""),
paste("MA",0:Q,sep=""))
table
}
temp_aic_table <- aic_table(temp,4,4)
temp <- global$Annual
aic_table <- function(data,P,Q){
table <- matrix(NA,(P+1),(Q+1))
for(p in 0:P) {
for(q in 0:Q) {
table[p+1,q+1] <- arima(data,order=c(p,0,q))$aic
}
}
dimnames(table) <- list(paste("AR",0:P, sep=""),
paste("MA",0:Q,sep=""))
table
}
temp_aic_table <- aic_table(huron_level,4,4)
require(knitr)
kable(temp_aic_table,digits=2)
dat <- read.table(file = "~/Library/Mobile Documents/com~apple~CloudDocs/531/Stats531/05/huron_level.csv", sep = ",", header = TRUE)
huron_level <- dat$Jan
temp <- global$Annual
aic_table <- function(data,P,Q){
table <- matrix(NA,(P+1),(Q+1))
for(p in 0:P) {
for(q in 0:Q) {
table[p+1,q+1] <- arima(data,order=c(p,0,q))$aic
}
}
dimnames(table) <- list(paste("AR",0:P, sep=""),
paste("MA",0:Q,sep=""))
table
}
temp_aic_table <- aic_table(temp,4,4)
dat <- read.table(file = "~/Library/Mobile Documents/com~apple~CloudDocs/531/Stats531/05/huron_level.csv", sep = ",", header = TRUE)
huron_level <- dat$Jan
temp <- global$Annual
aic_table <- function(data,P,Q){
table <- matrix(NA,(P+1),(Q+1))
for(p in 0:P) {
for(q in 0:Q) {
table[p+1,q+1] <- arima(data,order=c(p,0,q), method = "ML")$aic
}
}
dimnames(table) <- list(paste("AR",0:P, sep=""),
paste("MA",0:Q,sep=""))
table
}
temp_aic_table <- aic_table(temp,4,4)
arima(temp,order=c(1,0,1), method = "ML")
arima(temp,order=c(1,0,0), method = "ML")
arima(temp,order=c(1,0,2), method = "ML")
arima(temp,order=c(1,0,3), method = "ML")
arima(temp,order=c(2,0,3), method = "ML")
arima(temp,order=c(1,0,0), method = "ML")
arima(temp,order=c(0,0,0), method = "ML")
arima(temp,order=c(0,0,1), method = "ML")
arima(temp,order=c(2,0,1), method = "ML")
arima(temp,order=c(1,0,0), method = "ML")
arima(temp,order=c(2,0,0), method = "ML")
arima(temp,order=c(3,0,0), method = "ML")
arima(temp,order=c(0,0,1), method = "ML")
arima(temp,order=c(0,0,2), method = "ML")
arima(temp,order=c(0,0,3), method = "ML")
arima(global$Annual,order=c(1,0,0), method = "ML")
arima(global$Annual,order=c(1,0,1), method = "ML")
arima(global$Annual,order=c(5,0,6), method = "ML")
Jan <- read.table(file="http://ionides.github.io/531w24/01/ann_arbor_weather.csv",header=TRUE)
plot(Annual~Year,data=Jan,type="l", ylab = "AA Jan low temperature", main = "AA Jan low temperature time series")
Jan <- read.table(file="http://ionides.github.io/531w24/01/ann_arbor_weather.csv",header=TRUE)
plot(Low~Year,data=Jan,type="l", ylab = "AA Jan low temperature", main = "AA Jan low temperature time series")
# fit the model
summary(fit <- lm(Low ~ Year, data = Jan))
# plot the data and regression line
plot(Annual~Year,data=Jan,type="l", ylab = "AA Jan low temperature", main = "AA Jan low temperature time series")
# fit the model
summary(fit <- lm(Low ~ Year, data = Jan))
# plot the data and regression line
plot(Low~Year,data=Jan,type="l", ylab = "AA Jan low temperature", main = "AA Jan low temperature time series")
abline(fit)
plot(resid(fit), type = "l", main = "detrended")
plot(diff(Jan$Low), type = "l", main = "first differnce")
sigma <- mean(diff(Jan$Low))
sigma2 <- var(diff(Jan$Low))
sigma
sigma2
# fit the model
summary(fit <- lm(Low ~ Year, data = Jan))
# plot the data and regression line
plot(Low~Year,data=Jan,type="l", ylab = "AA Jan low temperature", main = "AA Jan low temperature time series")
abline(fit)
plot(resid(fit), type = "l", main = "detrended")
plot(diff(Jan$Low), type = "l", main = "first differnce")
sigma <- mean(diff(Jan$Low), na.rm = TRUE)
sigma2 <- var(diff(Jan$Low), na.rm = TRUE)
sigma
sigma2
Jan$Low
set.seed(123)
N <- length(global$Annual)
w <- rnorm(N, mean = 0, sd = sd(diff(global$Annual), na.rm = TRUE))
y <- numeric(N)
for (n in 2:N) {
y[n] <- y[n-1] + sigma + w[n]
}
plot(global$Year, y, type = "l", xlab = "Year", ylab = "temperature", main = "Random walk with drift: Simulation")
acf(resid(fit), 48, main = "detrended")
acf(diff(global$Annual), 48, main = "first difference")
set.seed(123)
N <- length(Jan$Low)
w <- rnorm(N, mean = 0, sd = sd(diff(Jan$Low), na.rm = TRUE))
y <- numeric(N)
for (n in 2:N) {
y[n] <- y[n-1] + sigma + w[n]
}
plot(Jan$Year, y, type = "l", xlab = "Year", ylab = "temperature", main = "Random walk with drift: Simulation")
var(diff(Jan$Low), na.rm = TRUE)
Jan$LOw
Jan$Low
acf(resid(fit), 48, main = "detrended")
acf(diff(Jan$Low), 48, main = "first difference")
acf(resid(fit), 48, main = "detrended")
acf(diff(Jan$Low), 48, main = "first difference", na.rm = TRUE)
acf(resid(fit)[!is.na(resid(fit))], 48, main = "detrended")
acf(diff(Jan$Low)[!is.na(diff(Jan$Low))], 48, main = "first difference")
# fit the model
summary(fit <- lm(Low ~ Year, data = Jan))
# plot the data and regression line
plot(Low~Year,data=Jan,type="l", ylab = "AA Jan low temperature", main = "AA Jan low temperature time series")
abline(fit)
diff(Jan$Low)
library(astsa)
lag1.plot(Jan$Low, 9)
library(astsa)
lag1.plot(Jan$Low[!is.na(Jan$Low)], 9)
temp <- Jan$Low
aic_table <- function(data,P,Q){
table <- matrix(NA,(P+1),(Q+1))
for(p in 0:P) {
for(q in 0:Q) {
table[p+1,q+1] <- tryCatch( {arima(data,order=c(p,0,q), method = "ML")$aic},
error = function(e){return(NA)})
}
}
dimnames(table) <- list(paste("AR",0:P, sep=""),
paste("MA",0:Q,sep=""))
table
}
temp_aic_table <- aic_table(temp,4,4)
require(knitr)
kable(temp_aic_table,digits=2)
arima(Jan$Low, order = c(0,0,0))
arima00(Jan$Low, order = c(0,0,0))
arima00 <- arima(Jan$Low, order = c(0,0,0))
arima10 <- arima(Jan$Low, order = c(1,0,0))
arima01 <- arima(Jan$Low, order = c(0,0,1))
arima22 <- arima(Jan$Low, order = c(2,0,2))
temp <- Jan$Low[!is.na(Jan$Low)]
aic_table <- function(data,P,Q){
table <- matrix(NA,(P+1),(Q+1))
for(p in 0:P) {
for(q in 0:Q) {
table[p+1,q+1] <- tryCatch( {arima(data,order=c(p,0,q), method = "ML")$aic},
error = function(e){return(NA)})
}
}
dimnames(table) <- list(paste("AR",0:P, sep=""),
paste("MA",0:Q,sep=""))
table
}
temp_aic_table <- aic_table(temp,4,4)
require(knitr)
kable(temp_aic_table,digits=2)
arima00 <- arima(temp, order = c(0,0,0))
arima10 <- arima(temp, order = c(1,0,0))
arima01 <- arima(temp, order = c(0,0,1))
arima22 <- arima(temp, order = c(2,0,2))
# plot the residues
par(mfrow = c(2,2))
plot(arima00$resid, main = "ARMA(0,0)", xlab = "Time", ylab = "resid")
plot(arima01$resid, main = "ARMA(0,1)", xlab = "Time", ylab = "resid")
plot(arima10$resid, main = "ARMA(1,0)", xlab = "Time", ylab = "resid")
plot(arima22$resid, main = "ARMA(2,2)", xlab = "Time", ylab = "resid")
arima00 <- arima(temp, order = c(0,0,0))
arima10 <- arima(temp, order = c(1,0,0))
arima01 <- arima(temp, order = c(0,0,1))
arima22 <- arima(temp, order = c(2,0,2))
# plot the residues
par(mfrow = c(2,2))
plot(arima00$resid, main = "ARMA(0,0)", xlab = "Time", ylab = "resid")
plot(arima01$resid, main = "ARMA(0,1)", xlab = "Time", ylab = "resid")
plot(arima10$resid, main = "ARMA(1,0)", xlab = "Time", ylab = "resid")
plot(arima22$resid, main = "ARMA(2,2)", xlab = "Time", ylab = "resid")
# plot the acf of the models
par(mfrow = c(2,2))
acf(arima00$resid, na.action = np.pass, main = "ARMA(0,0)")
arima00 <- arima(temp, order = c(0,0,0))
arima10 <- arima(temp, order = c(1,0,0))
arima01 <- arima(temp, order = c(0,0,1))
arima22 <- arima(temp, order = c(2,0,2))
# plot the residues
par(mfrow = c(2,2))
plot(arima00$resid, main = "ARMA(0,0)", xlab = "Time", ylab = "resid")
plot(arima01$resid, main = "ARMA(0,1)", xlab = "Time", ylab = "resid")
plot(arima10$resid, main = "ARMA(1,0)", xlab = "Time", ylab = "resid")
plot(arima22$resid, main = "ARMA(2,2)", xlab = "Time", ylab = "resid")
# plot the acf of the models
par(mfrow = c(2,2))
acf(arima00$resid, main = "ARMA(0,0)")
acf(arima01$resid, main = "ARMA(0,1)")
acf(arima10$resid, main = "ARMA(1,0)")
acf(arima22$resid, main = "ARMA(2,2)")
arima00 <- arima(temp, order = c(0,0,0))
arima10 <- arima(temp, order = c(1,0,0))
arima01 <- arima(temp, order = c(0,0,1))
arima22 <- arima(temp, order = c(2,0,2))
# plot the residues
par(mfrow = c(2,2))
plot(arima00$resid, main = "ARMA(0,0)", xlab = "Time", ylab = "resid")
plot(arima01$resid, main = "ARMA(0,1)", xlab = "Time", ylab = "resid")
plot(arima10$resid, main = "ARMA(1,0)", xlab = "Time", ylab = "resid")
plot(arima22$resid, main = "ARMA(2,2)", xlab = "Time", ylab = "resid")
# plot the acf of the models
par(mfrow = c(2,2))
acf(arima00$resid, 48, main = "ARMA(0,0)")
acf(arima01$resid, main = "ARMA(0,1)")
acf(arima10$resid, main = "ARMA(1,0)")
acf(arima22$resid, main = "ARMA(2,2)")
arima00 <- arima(temp, order = c(0,0,0))
arima10 <- arima(temp, order = c(1,0,0))
arima01 <- arima(temp, order = c(0,0,1))
arima22 <- arima(temp, order = c(2,0,2))
# plot the residues
par(mfrow = c(2,2))
plot(arima00$resid, main = "ARMA(0,0)", xlab = "Time", ylab = "resid")
plot(arima01$resid, main = "ARMA(0,1)", xlab = "Time", ylab = "resid")
plot(arima10$resid, main = "ARMA(1,0)", xlab = "Time", ylab = "resid")
plot(arima22$resid, main = "ARMA(2,2)", xlab = "Time", ylab = "resid")
# plot the acf of the models
par(mfrow = c(2,2))
acf(arima00$resid, 48, main = "ARMA(0,0)")
acf(arima01$resid, 48, main = "ARMA(0,1)")
acf(arima10$resid, 48, main = "ARMA(1,0)")
acf(arima22$resid, 48, main = "ARMA(2,2)")
arima22
help(arima.sim)
arima22
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = 1)
plot(Jan$Year, arma22, type = "l")
arima22
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = 1)
plot(Jan$Year, arma22, type = "l")
line(Jan$Year, Jan$Low)
arima22
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = 1)
plot(Jan$Year, arma22, type = "l")
lines(Jan$Year, Jan$Low)
arima22
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = 1)
plot(Jan$Year, arma22, type = "l")
arima22
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = 1)
plot(Jan$Year, arma22, type = "l", main = "ARMA(2,2) simulation")
arima22
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = 1)
plot(Jan$Year, arma22, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
temp
mean(Jan$Low)
mean(Jan$Low, na.rm = TRUE)
arima22
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = 1)
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
gtemp <- global$Annual
temp_aic_table <- aic_table(gtemp,4,4)
require(knitr)
kable(temp_aic_table,digits=2)
gtemp <- global$Annual
temp_aic_table <- aic_table(gtemp,5,5)
require(knitr)
kable(temp_aic_table,digits=2)
gtemp <- global$Annual
temp_aic_table <- aic_table(gtemp,6,6)
require(knitr)
kable(temp_aic_table,digits=2)
gtemp <- global$Annual
temp_aic_table <- aic_table(gtemp,10,10)
require(knitr)
kable(temp_aic_table,digits=2)
# fit the model
summary(fit <- lm(Low ~ Year, data = Jan))
# plot the data and regression line
plot(Low~Year,data=Jan,type="l", ylab = "AA Jan low temperature", main = "AA Jan low temperature time series")
abline(fit)
# fit the model
summary(fit <- lm(Annual ~ Year, data = global))
# plot the data and regression line
plot(Annual~Year,data=global,type="l", ylab = "global temperature", main = "global temperature time series")
abline(fit)
sigma <- mean(diff(global$Annual), na.rm = TRUE)
sigma2 <- var(diff(global$Annual), na.rm = TRUE)
sigma
sigma2
set.seed(123)
N <- length(global$Annual)
w <- rnorm(N, mean = 0, sd = sd(diff(global$Annual), na.rm = TRUE))
y <- numeric(N)
for (n in 2:N) {
y[n] <- y[n-1] + sigma + w[n]
}
plot(global$Year, y, type = "l", xlab = "Year", ylab = "temperature", main = "Random walk with drift: Simulation")
acf(resid(fit)[!is.na(resid(fit))], 48, main = "detrended")
acf(diff(global$Annual), 48, main = "first difference")
gtemp <- global$Annual
temp_aic_table <- aic_table(gtemp,10,10)
require(knitr)
kable(temp_aic_table,digits=2)
global <- read.table(file="http://ionides.github.io/531w24/hw03/Global_Temperature.txt",header=TRUE)
plot(Annual~Year,data=global,type="l")
global <- read.table(file="http://ionides.github.io/531w24/hw03/Global_Temperature.txt",header=TRUE)
plot(Annual~Year,data=global,type="l",ylab = "global temperature", main = "global temperature time series")
global <- read.table(file="http://ionides.github.io/531w24/hw03/Global_Temperature.txt",header=TRUE)
plot(Annual~Year,data=global,type="l",ylab = "global temperature", main = "global temperature time series")
lag1.plot(Jan$Low[!is.na(Jan$Low)], 9)
global <- read.table(file="http://ionides.github.io/531w24/hw03/Global_Temperature.txt",header=TRUE)
plot(Annual~Year,data=global,type="l",ylab = "global temperature", main = "global temperature time series")
lag1.plot(global$Annual, 9)
# show the result
arima22
Jan <- read.table(file="http://ionides.github.io/531w24/01/ann_arbor_weather.csv",header=TRUE)
Jan <- read.table(file="http://ionides.github.io/531w24/01/ann_arbor_weather.csv",header=TRUE)
x <- read.table(file="http://ionides.github.io/531w24/01/ann_arbor_weather.csv",header=TRUE)
Jan <- read.table(file="http://ionides.github.io/531w24/01/ann_arbor_weather.csv",header=TRUE)
Jan <- read.table(file="http://ionides.github.io/531w24/01/ann_arbor_weather.csv",header=TRUE)
Jan <- read.table(file="http://ionides.github.io/531w24/01/ann_arbor_weather.csv",header=TRUE)
Jan <- read.table(file="http://ionides.github.io/531w24/01/ann_arbor_weather.csv",header=TRUE)
Jan <- read.table(file="http://ionides.github.io/531w24/01/ann_arbor_weather.csv",header=TRUE)
plot(Low~Year,data=Jan,type="l", ylab = "AA Jan low temperature", main = "AA Jan low temperature time series")
arima00 <- arima(temp, order = c(0,0,0))
temp <- Jan$Low[!is.na(Jan$Low)]
aic_table <- function(data,P,Q){
table <- matrix(NA,(P+1),(Q+1))
for(p in 0:P) {
for(q in 0:Q) {
table[p+1,q+1] <- tryCatch( {arima(data,order=c(p,0,q), method = "ML")$aic},
error = function(e){return(NA)})
}
}
dimnames(table) <- list(paste("AR",0:P, sep=""),
paste("MA",0:Q,sep=""))
table
}
temp_aic_table <- aic_table(temp,4,4)
require(knitr)
kable(temp_aic_table,digits=2)
arima00 <- arima(temp, order = c(0,0,0))
arima10 <- arima(temp, order = c(1,0,0))
arima01 <- arima(temp, order = c(0,0,1))
arima22 <- arima(temp, order = c(2,0,2))
# plot the residues
par(mfrow = c(2,2))
plot(arima00$resid, main = "ARMA(0,0)", xlab = "Time", ylab = "resid")
plot(arima01$resid, main = "ARMA(0,1)", xlab = "Time", ylab = "resid")
plot(arima10$resid, main = "ARMA(1,0)", xlab = "Time", ylab = "resid")
plot(arima22$resid, main = "ARMA(2,2)", xlab = "Time", ylab = "resid")
# plot the acf of the models
par(mfrow = c(2,2))
acf(arima00$resid, 48, main = "ARMA(0,0)")
acf(arima01$resid, 48, main = "ARMA(0,1)")
acf(arima10$resid, 48, main = "ARMA(1,0)")
acf(arima22$resid, 48, main = "ARMA(2,2)")
# show the result
arima22
# check AR roots
AR_roots <- polyroot(c(1, -coef(arima22)[c("ar1","ar2")]))
AR_roots
# check MA roots
MA_roots <- polyroot(c(1, coef(arima22)[c("ma1","ma2")]))
MA_roots
# show the result
arima22
# compute Var(y_t)
var(arima22$fit)
# show the result
arima22
# compute Var(y_t)
var(Jan$Low)
# show the result
arima22
# compute Var(y_t)
var(Jan$Low, na.rm = TRUE)
(1-0.1698^2-0.5476^2)*56.33/(0.1166^2 + 0.5686^2)
# plot the simulation data
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = sqrt(112.24))
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
# plot the simulation data
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = sqrt(112.24))
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
lines(Jan$Low)
# plot the simulation data
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = sqrt(112.24))
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
lines(Jan$Year, Jan$Low)
# plot the simulation data
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = sqrt(112.24))
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
lines(Jan$Year, Jan$Low, col = "r", type = "l", labels = TRUE)
# plot the simulation data
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = sqrt(112.24))
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
lines(Jan$Year, Jan$Low, col = "red", type = "l", labels = TRUE)
# plot the simulation data
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = sqrt(112.24))
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
lines(Jan$Year, Jan$Low, col = "red", type = "l", legend("topright"))
# plot the simulation data
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = sqrt(112.24))
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
lines(Jan$Year, Jan$Low, col = "red", type = "l")
# plot the simulation data
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = sqrt(112.24))
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
lines(Jan$Year, Jan$Low, col = "red", type = "l")
legend("topright", legend=c("simulation", "true"),
col=c("black", "red"), cex=0.8)
# plot the simulation data
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = sqrt(112.24))
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
lines(Jan$Year, Jan$Low, col = "red", type = "l")
legend("topright", legend=c("simulation", "true"),
col=c("black", "red"), lty = c(1,1), cex=0.8)
# plot the simulation data
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = sqrt(112.24))
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
lines(Jan$Year, Jan$Low, col = "red", type = "l")
legend("topright", legend=c("simulation", "true"),
col=c("black", "red"), lty = c(1,1), cex=0.8)
