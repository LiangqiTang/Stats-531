sigma2
# fit the model
summary(fit <- lm(Low ~ Year, data = Jan))
# plot the data and regression line
plot(Low~Year,data=Jan,type="l", ylab = "AA Jan low temperature", main = "AA Jan low temperature time series")
abline(fit)
plot(resid(fit), type = "l", main = "detrended")
plot(diff(Jan$Low), type = "l", main = "first differnce")
sigma <- mean(diff(Jan$Low), na.rm = TRUE)
sigma2 <- var(diff(Jan$Low), na.rm = TRUE)
sigma
sigma2
Jan$Low
set.seed(123)
N <- length(global$Annual)
w <- rnorm(N, mean = 0, sd = sd(diff(global$Annual), na.rm = TRUE))
y <- numeric(N)
for (n in 2:N) {
y[n] <- y[n-1] + sigma + w[n]
}
plot(global$Year, y, type = "l", xlab = "Year", ylab = "temperature", main = "Random walk with drift: Simulation")
acf(resid(fit), 48, main = "detrended")
acf(diff(global$Annual), 48, main = "first difference")
set.seed(123)
N <- length(Jan$Low)
w <- rnorm(N, mean = 0, sd = sd(diff(Jan$Low), na.rm = TRUE))
y <- numeric(N)
for (n in 2:N) {
y[n] <- y[n-1] + sigma + w[n]
}
plot(Jan$Year, y, type = "l", xlab = "Year", ylab = "temperature", main = "Random walk with drift: Simulation")
var(diff(Jan$Low), na.rm = TRUE)
Jan$LOw
Jan$Low
acf(resid(fit), 48, main = "detrended")
acf(diff(Jan$Low), 48, main = "first difference")
acf(resid(fit), 48, main = "detrended")
acf(diff(Jan$Low), 48, main = "first difference", na.rm = TRUE)
acf(resid(fit)[!is.na(resid(fit))], 48, main = "detrended")
acf(diff(Jan$Low)[!is.na(diff(Jan$Low))], 48, main = "first difference")
# fit the model
summary(fit <- lm(Low ~ Year, data = Jan))
# plot the data and regression line
plot(Low~Year,data=Jan,type="l", ylab = "AA Jan low temperature", main = "AA Jan low temperature time series")
abline(fit)
diff(Jan$Low)
library(astsa)
lag1.plot(Jan$Low, 9)
library(astsa)
lag1.plot(Jan$Low[!is.na(Jan$Low)], 9)
temp <- Jan$Low
aic_table <- function(data,P,Q){
table <- matrix(NA,(P+1),(Q+1))
for(p in 0:P) {
for(q in 0:Q) {
table[p+1,q+1] <- tryCatch( {arima(data,order=c(p,0,q), method = "ML")$aic},
error = function(e){return(NA)})
}
}
dimnames(table) <- list(paste("AR",0:P, sep=""),
paste("MA",0:Q,sep=""))
table
}
temp_aic_table <- aic_table(temp,4,4)
require(knitr)
kable(temp_aic_table,digits=2)
arima(Jan$Low, order = c(0,0,0))
arima00(Jan$Low, order = c(0,0,0))
arima00 <- arima(Jan$Low, order = c(0,0,0))
arima10 <- arima(Jan$Low, order = c(1,0,0))
arima01 <- arima(Jan$Low, order = c(0,0,1))
arima22 <- arima(Jan$Low, order = c(2,0,2))
temp <- Jan$Low[!is.na(Jan$Low)]
aic_table <- function(data,P,Q){
table <- matrix(NA,(P+1),(Q+1))
for(p in 0:P) {
for(q in 0:Q) {
table[p+1,q+1] <- tryCatch( {arima(data,order=c(p,0,q), method = "ML")$aic},
error = function(e){return(NA)})
}
}
dimnames(table) <- list(paste("AR",0:P, sep=""),
paste("MA",0:Q,sep=""))
table
}
temp_aic_table <- aic_table(temp,4,4)
require(knitr)
kable(temp_aic_table,digits=2)
arima00 <- arima(temp, order = c(0,0,0))
arima10 <- arima(temp, order = c(1,0,0))
arima01 <- arima(temp, order = c(0,0,1))
arima22 <- arima(temp, order = c(2,0,2))
# plot the residues
par(mfrow = c(2,2))
plot(arima00$resid, main = "ARMA(0,0)", xlab = "Time", ylab = "resid")
plot(arima01$resid, main = "ARMA(0,1)", xlab = "Time", ylab = "resid")
plot(arima10$resid, main = "ARMA(1,0)", xlab = "Time", ylab = "resid")
plot(arima22$resid, main = "ARMA(2,2)", xlab = "Time", ylab = "resid")
arima00 <- arima(temp, order = c(0,0,0))
arima10 <- arima(temp, order = c(1,0,0))
arima01 <- arima(temp, order = c(0,0,1))
arima22 <- arima(temp, order = c(2,0,2))
# plot the residues
par(mfrow = c(2,2))
plot(arima00$resid, main = "ARMA(0,0)", xlab = "Time", ylab = "resid")
plot(arima01$resid, main = "ARMA(0,1)", xlab = "Time", ylab = "resid")
plot(arima10$resid, main = "ARMA(1,0)", xlab = "Time", ylab = "resid")
plot(arima22$resid, main = "ARMA(2,2)", xlab = "Time", ylab = "resid")
# plot the acf of the models
par(mfrow = c(2,2))
acf(arima00$resid, na.action = np.pass, main = "ARMA(0,0)")
arima00 <- arima(temp, order = c(0,0,0))
arima10 <- arima(temp, order = c(1,0,0))
arima01 <- arima(temp, order = c(0,0,1))
arima22 <- arima(temp, order = c(2,0,2))
# plot the residues
par(mfrow = c(2,2))
plot(arima00$resid, main = "ARMA(0,0)", xlab = "Time", ylab = "resid")
plot(arima01$resid, main = "ARMA(0,1)", xlab = "Time", ylab = "resid")
plot(arima10$resid, main = "ARMA(1,0)", xlab = "Time", ylab = "resid")
plot(arima22$resid, main = "ARMA(2,2)", xlab = "Time", ylab = "resid")
# plot the acf of the models
par(mfrow = c(2,2))
acf(arima00$resid, main = "ARMA(0,0)")
acf(arima01$resid, main = "ARMA(0,1)")
acf(arima10$resid, main = "ARMA(1,0)")
acf(arima22$resid, main = "ARMA(2,2)")
arima00 <- arima(temp, order = c(0,0,0))
arima10 <- arima(temp, order = c(1,0,0))
arima01 <- arima(temp, order = c(0,0,1))
arima22 <- arima(temp, order = c(2,0,2))
# plot the residues
par(mfrow = c(2,2))
plot(arima00$resid, main = "ARMA(0,0)", xlab = "Time", ylab = "resid")
plot(arima01$resid, main = "ARMA(0,1)", xlab = "Time", ylab = "resid")
plot(arima10$resid, main = "ARMA(1,0)", xlab = "Time", ylab = "resid")
plot(arima22$resid, main = "ARMA(2,2)", xlab = "Time", ylab = "resid")
# plot the acf of the models
par(mfrow = c(2,2))
acf(arima00$resid, 48, main = "ARMA(0,0)")
acf(arima01$resid, main = "ARMA(0,1)")
acf(arima10$resid, main = "ARMA(1,0)")
acf(arima22$resid, main = "ARMA(2,2)")
arima00 <- arima(temp, order = c(0,0,0))
arima10 <- arima(temp, order = c(1,0,0))
arima01 <- arima(temp, order = c(0,0,1))
arima22 <- arima(temp, order = c(2,0,2))
# plot the residues
par(mfrow = c(2,2))
plot(arima00$resid, main = "ARMA(0,0)", xlab = "Time", ylab = "resid")
plot(arima01$resid, main = "ARMA(0,1)", xlab = "Time", ylab = "resid")
plot(arima10$resid, main = "ARMA(1,0)", xlab = "Time", ylab = "resid")
plot(arima22$resid, main = "ARMA(2,2)", xlab = "Time", ylab = "resid")
# plot the acf of the models
par(mfrow = c(2,2))
acf(arima00$resid, 48, main = "ARMA(0,0)")
acf(arima01$resid, 48, main = "ARMA(0,1)")
acf(arima10$resid, 48, main = "ARMA(1,0)")
acf(arima22$resid, 48, main = "ARMA(2,2)")
arima22
help(arima.sim)
arima22
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = 1)
plot(Jan$Year, arma22, type = "l")
arima22
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = 1)
plot(Jan$Year, arma22, type = "l")
line(Jan$Year, Jan$Low)
arima22
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = 1)
plot(Jan$Year, arma22, type = "l")
lines(Jan$Year, Jan$Low)
arima22
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = 1)
plot(Jan$Year, arma22, type = "l")
arima22
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = 1)
plot(Jan$Year, arma22, type = "l", main = "ARMA(2,2) simulation")
arima22
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = 1)
plot(Jan$Year, arma22, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
temp
mean(Jan$Low)
mean(Jan$Low, na.rm = TRUE)
arima22
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = 1)
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
gtemp <- global$Annual
temp_aic_table <- aic_table(gtemp,4,4)
require(knitr)
kable(temp_aic_table,digits=2)
gtemp <- global$Annual
temp_aic_table <- aic_table(gtemp,5,5)
require(knitr)
kable(temp_aic_table,digits=2)
gtemp <- global$Annual
temp_aic_table <- aic_table(gtemp,6,6)
require(knitr)
kable(temp_aic_table,digits=2)
gtemp <- global$Annual
temp_aic_table <- aic_table(gtemp,10,10)
require(knitr)
kable(temp_aic_table,digits=2)
# fit the model
summary(fit <- lm(Low ~ Year, data = Jan))
# plot the data and regression line
plot(Low~Year,data=Jan,type="l", ylab = "AA Jan low temperature", main = "AA Jan low temperature time series")
abline(fit)
# fit the model
summary(fit <- lm(Annual ~ Year, data = global))
# plot the data and regression line
plot(Annual~Year,data=global,type="l", ylab = "global temperature", main = "global temperature time series")
abline(fit)
sigma <- mean(diff(global$Annual), na.rm = TRUE)
sigma2 <- var(diff(global$Annual), na.rm = TRUE)
sigma
sigma2
set.seed(123)
N <- length(global$Annual)
w <- rnorm(N, mean = 0, sd = sd(diff(global$Annual), na.rm = TRUE))
y <- numeric(N)
for (n in 2:N) {
y[n] <- y[n-1] + sigma + w[n]
}
plot(global$Year, y, type = "l", xlab = "Year", ylab = "temperature", main = "Random walk with drift: Simulation")
acf(resid(fit)[!is.na(resid(fit))], 48, main = "detrended")
acf(diff(global$Annual), 48, main = "first difference")
gtemp <- global$Annual
temp_aic_table <- aic_table(gtemp,10,10)
require(knitr)
kable(temp_aic_table,digits=2)
global <- read.table(file="http://ionides.github.io/531w24/hw03/Global_Temperature.txt",header=TRUE)
plot(Annual~Year,data=global,type="l")
global <- read.table(file="http://ionides.github.io/531w24/hw03/Global_Temperature.txt",header=TRUE)
plot(Annual~Year,data=global,type="l",ylab = "global temperature", main = "global temperature time series")
global <- read.table(file="http://ionides.github.io/531w24/hw03/Global_Temperature.txt",header=TRUE)
plot(Annual~Year,data=global,type="l",ylab = "global temperature", main = "global temperature time series")
lag1.plot(Jan$Low[!is.na(Jan$Low)], 9)
global <- read.table(file="http://ionides.github.io/531w24/hw03/Global_Temperature.txt",header=TRUE)
plot(Annual~Year,data=global,type="l",ylab = "global temperature", main = "global temperature time series")
lag1.plot(global$Annual, 9)
# show the result
arima22
Jan <- read.table(file="http://ionides.github.io/531w24/01/ann_arbor_weather.csv",header=TRUE)
Jan <- read.table(file="http://ionides.github.io/531w24/01/ann_arbor_weather.csv",header=TRUE)
x <- read.table(file="http://ionides.github.io/531w24/01/ann_arbor_weather.csv",header=TRUE)
Jan <- read.table(file="http://ionides.github.io/531w24/01/ann_arbor_weather.csv",header=TRUE)
Jan <- read.table(file="http://ionides.github.io/531w24/01/ann_arbor_weather.csv",header=TRUE)
Jan <- read.table(file="http://ionides.github.io/531w24/01/ann_arbor_weather.csv",header=TRUE)
Jan <- read.table(file="http://ionides.github.io/531w24/01/ann_arbor_weather.csv",header=TRUE)
Jan <- read.table(file="http://ionides.github.io/531w24/01/ann_arbor_weather.csv",header=TRUE)
plot(Low~Year,data=Jan,type="l", ylab = "AA Jan low temperature", main = "AA Jan low temperature time series")
arima00 <- arima(temp, order = c(0,0,0))
temp <- Jan$Low[!is.na(Jan$Low)]
aic_table <- function(data,P,Q){
table <- matrix(NA,(P+1),(Q+1))
for(p in 0:P) {
for(q in 0:Q) {
table[p+1,q+1] <- tryCatch( {arima(data,order=c(p,0,q), method = "ML")$aic},
error = function(e){return(NA)})
}
}
dimnames(table) <- list(paste("AR",0:P, sep=""),
paste("MA",0:Q,sep=""))
table
}
temp_aic_table <- aic_table(temp,4,4)
require(knitr)
kable(temp_aic_table,digits=2)
arima00 <- arima(temp, order = c(0,0,0))
arima10 <- arima(temp, order = c(1,0,0))
arima01 <- arima(temp, order = c(0,0,1))
arima22 <- arima(temp, order = c(2,0,2))
# plot the residues
par(mfrow = c(2,2))
plot(arima00$resid, main = "ARMA(0,0)", xlab = "Time", ylab = "resid")
plot(arima01$resid, main = "ARMA(0,1)", xlab = "Time", ylab = "resid")
plot(arima10$resid, main = "ARMA(1,0)", xlab = "Time", ylab = "resid")
plot(arima22$resid, main = "ARMA(2,2)", xlab = "Time", ylab = "resid")
# plot the acf of the models
par(mfrow = c(2,2))
acf(arima00$resid, 48, main = "ARMA(0,0)")
acf(arima01$resid, 48, main = "ARMA(0,1)")
acf(arima10$resid, 48, main = "ARMA(1,0)")
acf(arima22$resid, 48, main = "ARMA(2,2)")
# show the result
arima22
# check AR roots
AR_roots <- polyroot(c(1, -coef(arima22)[c("ar1","ar2")]))
AR_roots
# check MA roots
MA_roots <- polyroot(c(1, coef(arima22)[c("ma1","ma2")]))
MA_roots
# show the result
arima22
# compute Var(y_t)
var(arima22$fit)
# show the result
arima22
# compute Var(y_t)
var(Jan$Low)
# show the result
arima22
# compute Var(y_t)
var(Jan$Low, na.rm = TRUE)
(1-0.1698^2-0.5476^2)*56.33/(0.1166^2 + 0.5686^2)
# plot the simulation data
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = sqrt(112.24))
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
# plot the simulation data
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = sqrt(112.24))
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
lines(Jan$Low)
# plot the simulation data
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = sqrt(112.24))
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
lines(Jan$Year, Jan$Low)
# plot the simulation data
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = sqrt(112.24))
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
lines(Jan$Year, Jan$Low, col = "r", type = "l", labels = TRUE)
# plot the simulation data
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = sqrt(112.24))
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
lines(Jan$Year, Jan$Low, col = "red", type = "l", labels = TRUE)
# plot the simulation data
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = sqrt(112.24))
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
lines(Jan$Year, Jan$Low, col = "red", type = "l", legend("topright"))
# plot the simulation data
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = sqrt(112.24))
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
lines(Jan$Year, Jan$Low, col = "red", type = "l")
# plot the simulation data
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = sqrt(112.24))
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
lines(Jan$Year, Jan$Low, col = "red", type = "l")
legend("topright", legend=c("simulation", "true"),
col=c("black", "red"), cex=0.8)
# plot the simulation data
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = sqrt(112.24))
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
lines(Jan$Year, Jan$Low, col = "red", type = "l")
legend("topright", legend=c("simulation", "true"),
col=c("black", "red"), lty = c(1,1), cex=0.8)
# plot the simulation data
arma22 <- arima.sim(list(ar = c(0.1698, 0.5476), ma = c(-0.1166, -0.5686)), n = length(Jan$Low), sd = sqrt(112.24))
plot(Jan$Year, arma22 - 2.84, type = "l", xlab = "Year", ylab = "simulation temp", main = "ARMA(2,2) simulation")
lines(Jan$Year, Jan$Low, col = "red", type = "l")
legend("topright", legend=c("simulation", "true"),
col=c("black", "red"), lty = c(1,1), cex=0.8)
install.packages("TSA")
# load the package
library(TSA)
ARMAspec(model = list(ar = c(1.5, -0.8)))
# load the package
library(TSA)
ARMAspec(model = list(ar = c(1.5, -0.8)), freq = seq(0, 0.3, 0.001))
# load the package
library(TSA)
ARMAspec(model = list(ar = c(1.5, -0.8)), freq = seq(0, 0.3, 0.001), main = "Spectral Density Plot")
help(arima.acf)
??ARMAacf
install.packages("
plotArmaTrueacf")
install.packages("plotArmaTrueacf")
library(plotArmaTrueacf)
install.packages("FinTS")
library(FinTS)
# load the package
library(TSA)
# plot the spectral density
ARMAspec(model = list(ar = c(1.5, -0.8)), freq = seq(0, 0.3, 0.001), main = "Spectral Density Plot")
# plot the autocovariance
library(FinTS)
plotArmaTrueacf(list(ar = c(1.5, -0.8)))
install.packages("polynom")
# load the package
library(TSA)
# plot the spectral density
ARMAspec(model = list(ar = c(1.5, -0.8)), freq = seq(0, 0.3, 0.001), main = "Spectral Density Plot")
# plot the autocovariance
library(FinTS)
plotArmaTrueacf(list(ar = c(1.5, -0.8)))
# load the package
library(TSA)
# plot the spectral density
ARMAspec(model = list(ar = c(1.5, -0.8)), freq = seq(0, 0.3, 0.001), main = "Spectral Density Plot")
# plot the autocovariance
library(FinTS)
plotArmaTrueacf(list(ar = c(1.5, -0.8)), type = "covariance")
# load the package
library(TSA)
# plot the spectral density
ARMAspec(model = list(ar = c(1.5, -0.8)), freq = seq(0, 0.3, 0.001), main = "Spectral Density Plot")
# plot the autocovariance
library(FinTS)
plotArmaTrueacf(list(ar = c(1.5, -0.8)))
help(plotArmaTrueacf)
# load the package
library(TSA)
# plot the spectral density
ARMAspec(model = list(ar = c(1.5, -0.8)), freq = seq(0, 0.3, 0.001), main = "Spectral Density Plot")
# plot the autocovariance
# since the sigma^2 is unknown, we suppose here sigma = 1 and plot the simulation of the acf
model_AR = arima.sim(model_AR = list(ar = c(1.5, -0.8)), n=10000, sigma = 1)
# load the package
library(TSA)
# plot the spectral density
ARMAspec(model = list(ar = c(1.5, -0.8)), freq = seq(0, 0.3, 0.001), main = "Spectral Density Plot")
# plot the autocovariance
# since the sigma^2 is unknown, we suppose here sigma = 1 and plot the simulation of the acf
model_AR = arima.sim(model = list(ar = c(1.5, -0.8)), n=10000, sigma = 1)
# load the package
library(TSA)
# plot the spectral density
ARMAspec(model = list(ar = c(1.5, -0.8)), freq = seq(0, 0.3, 0.001), main = "Spectral Density Plot")
# plot the autocovariance
# since the sigma^2 is unknown, we suppose here sigma = 1 and plot the simulation of the acf
model_AR = arima.sim(model = list(ar = c(1.5, -0.8)), n=10000, sd = 1)
acf(model_AR, type="covariance")
# plot the spectral density
ARMAspec(model = list(ma = c(1, 1)), main = "Spectral Density Plot")
# plot the autocovariance
# since the sigma^2 is unknown, we suppose here sigma = 1 and plot the simulation of the acf
model_MA = arima.sim(model = list(ar = c(1, 1)), n=10000, sd = 1)
# plot the spectral density
ARMAspec(model = list(ma = c(1, 1)), main = "Spectral Density Plot")
# plot the autocovariance
# since the sigma^2 is unknown, we suppose here sigma = 1 and plot the simulation of the acf
model_MA = arima.sim(model = list(ma = c(1, 1)), n=10000, sd = 1)
acf(model_MA, type="covariance", main = "Autocovariance Plot")
# load the package
library(TSA)
# plot the spectral density
ARMAspec(model = list(ar = c(1.5, -0.8)), main = "Spectral Density Plot")
# plot the autocovariance
# since the sigma^2 is unknown, we suppose here sigma = 1 and plot the simulation of the acf
model_AR = arima.sim(model = list(ar = c(1.5, -0.8)), n=10000, sd = 1)
acf(model_AR, type="covariance", main = "Autocovariance Plot")
# load the data
data <- read.table(file="https://ionides.github.io/531w24/hw04/sunspots.txt", header = TRUE)
# plot the time series
# load the data
data <- read.table(file="https://ionides.github.io/531w24/hw04/sunspots.txt", header = TRUE)
# plot the time series
year <- data.Year
# load the data
data <- read.table(file="https://ionides.github.io/531w24/hw04/sunspots.txt", header = TRUE)
# plot the time series
year <- data$Year
number <- data$Number
plot(year, number, type = "l")
# load the data
data <- read.table(file="https://ionides.github.io/531w24/hw04/sunspots.txt", header = TRUE)
# plot the time series
year <- data$Year
number <- data$Number
plot(year, number, type = "l", main = "time series plot of original data")
data$Time
# load the data
data <- read.table(file="https://ionides.github.io/531w24/hw04/sunspots.txt", header = TRUE)
# plot the time series
Time <- data$Time
Number <- data$Number
plot(Time, Number, type = "l", main = "time series plot of original data")
spectrum(Number, main = "Unsmoothed periodogram")
help(spectrum)
# smoothed periodogram
spectrum(Number, spans = c(3,5,7), main = "Smoothed periodogram")
# smoothed periodogram
spectrum(Number, spans = c(30,50,70), main = "Smoothed periodogram")
# smoothed periodogram
spectrum(Number, spans = c(30,50,30), main = "Smoothed periodogram")
# smoothed periodogram
spectrum(Number, spans = c(20,30,20), main = "Smoothed periodogram")
# smoothed periodogram
spectrum_us <- spectrum(Number, spans = c(20,30,20), main = "Smoothed periodogram")
# smoothed periodogram
spectrum_s <- spectrum(Number, spans = c(20,30,20), main = "Smoothed periodogram")
# unsmoothed periodogram
spectrum_us <- spectrum(Number, main = "Unsmoothed periodogram")
freq_s <- spectrum_s$freq[which.max(spectrum_s$spec)]
freq_s
freq_s <- spectrum_s$freq[which.max(spectrum_s$spec)]
freq_s
1/0.007111111/12
# smoothed periodogram
spectrum_s <- spectrum(Number, spans = c(20,30,20), main = "Smoothed periodogram")
abline(spectrum_s$freq[which.max(spectrum_s$spec)])
# smoothed periodogram
spectrum_s <- spectrum(Number, spans = c(20,30,20), main = "Smoothed periodogram")
abline(v = spectrum_s$freq[which.max(spectrum_s$spec)], lty = "dotted")
spectrum_p <- spectrum(Number, method = "ar", main = "Parametric periodogram")
spectrum_p <- spectrum(Number, method = "ar", main = "Parametric periodogram")
abline(v = spectrum_p$freq[which.max(spectrum_p$spec)], lty = "dotted")
freq_p <- spectrum_p$freq[which.max(spectrum_p$spec)]
freq_p
1/0.008016032/12
data <- read.table(file="Home/Library/Mobile Documents/com~apple~CloudDocs/531/Stats531/midterm/archive/KwhConsumptionBlower78_1.csv", header = TRUE)
data <- read.table(file="Home/Library/Mobile Documents/com~apple~CloudDocs/531/Stats531/midterm/archive/KwhConsumptionBlower78_1.csv", header = TRUE)
data <- read.table(file="~/Library/Mobile Documents/com~apple~CloudDocs/531/Stats531/midterm/archive/KwhConsumptionBlower78_1.csv", header = TRUE)
data <- read.table(file="~/Library/Mobile Documents/com~apple~CloudDocs/531/Stats531/midterm/archive/KwhConsumptionBlower78_1.csv")
data <- read.table(file="~/Library/Mobile Documents/com~apple~CloudDocs/531/Stats531/midterm/archive/KwhConsumptionBlower78_1.csv", header = TRUE)
data <- read.table(file="~/Library/Mobile Documents/com~apple~CloudDocs/531/Stats531/midterm/archive/KwhConsumptionBlower78_1.csv", header = TRUE, sep = ",")
View(data)
update.packages()
Yes
source("https://ionides.github.io/531w24/pomp_prep/packages.R")
source("https://kingaa.github.io/scripts/pompTest.R")
install.packages("pomp")
source("https://kingaa.github.io/scripts/pompTest.R")
